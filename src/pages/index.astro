---
import Layout from '../layouts/Layout.astro';
import CinematicHero from '../components/hero/CinematicHero';
import Header from '../components/Header.astro';
import Hero from '../components/hero/Hero.astro';
import SeasonalServices from '../components/services/SeasonalServices';
import BeforeAfterSlider from '../components/ui/BeforeAfterSlider';
import PricingTable from '../components/pricing/PricingTable';
import Footer from '../components/Footer.astro';
import { getServices, getPortfolioItems, getPricingPlans } from '../lib/wp';

const [services, portfolio, plans] = await Promise.all([
  getServices(),
  getPortfolioItems(),
  getPricingPlans()
]);

const featuredProject = portfolio[0]; // Take the latest project
---

<Layout title="Yard. | Landscape Design Studio">
  <Header />
  <CinematicHero client:load />

  <main class="relative z-10 bg-[#f9f8f6]">
    {/* Services Section */}
    <section class="py-24 md:py-32 container mx-auto">
      <div class="text-center mb-16 px-4">
        <h2 class="text-4xl md:text-5xl font-serif text-[#1a4031] mb-4">Наши Услуги</h2>
        <p class="text-stone-600 max-w-2xl mx-auto">
          Комплексный подход к созданию и уходу за вашим садом в любое время года.
        </p>
      </div>
      <SeasonalServices client:visible services={services} />
      <div class="text-center mt-12">
        <a href="/services" class="inline-flex items-center text-[#1a4031] font-medium hover:text-[#88a858] transition-colors">
          Посмотреть все услуги →
        </a>
      </div>
    </section>

    {/* Portfolio Section */}
    <section class="py-24 md:py-32 bg-white">
      <div class="container mx-auto px-4">
        <div class="text-center mb-16">
          <h2 class="text-4xl md:text-5xl font-serif text-[#1a4031] mb-4">Преображение</h2>
          <p class="text-stone-600 max-w-2xl mx-auto">
            Посмотрите, как мы меняем пространство.
          </p>
        </div>

        <div class="max-w-5xl mx-auto">
          {featuredProject ? (
            <div class="space-y-8">
              <BeforeAfterSlider 
                client:visible 
                beforeImage={featuredProject.before} 
                afterImage={featuredProject.after} 
                alt={featuredProject.title} 
              />
              <div class="text-center">
                <h3 class="text-2xl font-serif text-[#1a4031] mb-2">{featuredProject.title}</h3>
                <p class="text-stone-500">{featuredProject.location} • {featuredProject.area} • {featuredProject.duration}</p>
              </div>
            </div>
          ) : (
            <div class="text-center py-20 bg-stone-50 rounded-3xl border border-stone-100">
              <p class="text-stone-400">Добавьте проект в WordPress, чтобы увидеть результат.</p>
            </div>
          )}
        </div>
        <div class="text-center mt-12">
          <a href="/projects" class="inline-flex items-center text-[#1a4031] font-medium hover:text-[#88a858] transition-colors">
            Все проекты →
          </a>
        </div>
      </div>
    </section>

    {/* Pricing Section */}
    <section class="py-24 md:py-32 bg-[#f9f8f6]">
      <div class="container mx-auto px-4">
        <div class="text-center mb-16">
          <h2 class="text-4xl md:text-5xl font-serif text-[#1a4031] mb-4">Стоимость</h2>
          <p class="text-stone-600 max-w-2xl mx-auto">
            Прозрачные тарифы для частных клиентов и бизнеса.
          </p>
        </div>
        <PricingTable client:visible plans={plans} />
        <div class="text-center mt-12">
          <a href="/pricing" class="inline-flex items-center text-[#1a4031] font-medium hover:text-[#88a858] transition-colors">
            Полный прайс-лист →
          </a>
        </div>
      </div>
    </section>

    {/* CTA Section */}
    <section class="py-24 md:py-32 bg-white">
      <div class="container mx-auto px-4 text-center">
        <div class="max-w-3xl mx-auto">
          <h2 class="text-4xl md:text-5xl font-serif text-[#1a4031] mb-6">Готовы начать преображение?</h2>
          <p class="text-lg text-stone-600 mb-10 leading-relaxed">
            Оставьте заявку, и мы свяжемся с вами для обсуждения деталей вашего будущего сада.
          </p>
          <a href="/contact" class="inline-block bg-[#88a858] text-white px-10 py-4 rounded-full font-medium text-lg hover:bg-[#7a964e] transition-all shadow-glow hover:-translate-y-1">
            Обсудить проект
          </a>
        </div>
      </div>
    </section>
  </main>

  <Footer />
</Layout>
